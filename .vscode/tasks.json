{
    "version": "2.0.0",
    "tasks": [
      {
        "label":"build_SERIAL",
        "dependsOn":[
          "build_dir_serial",
          "cmake_serial",
          "compile_serial",
          "test_dir_serial"
        ],
        "dependsOrder": "sequence"
        // "group": {
        //   "kind": "build",
        //   "isDefault": true
        // }
      },
      {
        "label": "build_dir_serial",
        "type": "shell",
        "command": "if [ ! -d ./build_SERIAL ]; then mkdir build_SERIAL; else cd build_SERIAL && rm -rf * ;fi"
      },
      {
        "label": "cmake_serial",
        "type": "shell",
        "command": "cd build_SERIAL && cmake ../src -DSYST=dell_notebook -DBUILD_TYPE=SERIAL"
      },
      {
        "label": "compile_serial",
        "type": "shell",
        "command": "cd build_SERIAL && make -j"
      },
      {
        "label": "test_dir_serial",
        "type": "shell",
        "command":"if [ ! -d ./test_serial ]; then mkdir test_serial;fi"
      },
      //-----------------------------------------------------------------------------------------------------------------//
      {
        "label":"build_PARALLEL",
        "dependsOn":[
          "build_dir_parallel",
          "cmake_parallel",
          "compile_parallel",
          "test_dir_parallel"
        ],
        "dependsOrder": "sequence"
      },
      {
        "label": "build_dir_parallel",
        "type": "shell",
        "command": "if [ ! -d ./build_PARALLEL ]; then mkdir build_PARALLEL; else cd build_PARALLEL && rm -rf * ;fi"
      },
      {
        "label": "cmake_parallel",
        "type": "shell",
        "command": "cd build_PARALLEL && cmake ../src -DSYST=dell_notebook -DBUILD_TYPE=PARALLEL"
      },
      {
        "label": "compile_parallel",
        "type": "shell",
        "command": "cd build_PARALLEL && make -j"
      },
      {
        "label": "test_dir_parallel",
        "type": "shell",
        "command":"if [ ! -d ./test_parallel ]; then mkdir test_parallel;fi"
      },
      //-----------------------------------------------------------------------------------------------------------------//
      {
        "label":"build_DEBUG",
        "dependsOn":[
          "build_dir_debug_serial",
          "cmake_debug_serial",
          "compile_debug_serial",
          "test_dir_debug_serial",
          "clear_test_debug",
          "create_links_debug_serial",
          "run_ini_debug_serial"
        ],
        "dependsOrder": "sequence"
      },
      {
        "label": "build_dir_debug_serial",
        "type": "shell",
        "command": "if [ ! -d ./build_DEBUG ]; then mkdir build_DEBUG; else cd build_DEBUG && rm -rf * ;fi"
      },
      {
        "label": "cmake_debug_serial",
        "type": "shell",
        "command": "cd build_DEBUG && cmake ../src -DSYST=dell_notebook -DBUILD_TYPE=DEBUG"
      },
      {
        "label": "compile_debug_serial",
        "type": "shell",
        "command": "cd build_DEBUG && make -j"
      },
      {
        "label": "test_dir_debug_serial",
        "type": "shell",
        "command":"if [ ! -d ./test_debug ]; then mkdir test_debug;fi"
      },
      {
        "label": "clear_test_debug",
        "type": "shell",
        "command": "cd test_debug && rm -rf * "//find . ! -name dns.ini -delete"
      },
      {
        "label": "create_links_debug_serial",
        "type": "shell",
        "command": "cd test_debug && ln -s ../test_files/dns.ini && ln -s ../build_DEBUG/inigrid.x && ln -s ../build_DEBUG/inirand.x && ln -s ../build_DEBUG/iniscal.x && ln -s ../build_DEBUG/iniflow.x && ln -s ../build_DEBUG/dns.x"
      },
      {
        "label": "run_ini_debug_serial",
        "type": "shell",
        "command": "cd test_debug && ./inigrid.x && ./inirand.x && ./iniflow.x && ./iniscal.x && mv flow.ics.1 flow.0.1 && mv flow.ics.2 flow.0.2 && mv flow.ics.3 flow.0.3 && mv scal.ics.1 scal.0.1"
      },
      //-----------------------------------------------------------------------------------------------------------------//
      {
        "label":"prep_test_serial",
        "dependsOn":[
          "clear_test_serial",
          "create_links_serial",
          "run_ini_serial"
        ],
        "dependsOrder": "sequence"
      },
      {
        "label": "clear_test_serial",
        "type": "shell",
        "command": "cd test_serial && rm -rf * "//find . ! -name dns.ini -delete"
      },
      {
        "label": "create_links_serial",
        "type": "shell",
        "command": "cd test_serial && ln -s ../test_files/dns.ini && ln -s ../build_SERIAL/inigrid.x && ln -s ../build_SERIAL/inirand.x && ln -s ../build_SERIAL/iniscal.x && ln -s ../build_SERIAL/iniflow.x && ln -s ../build_SERIAL/dns.x"
      },
      {
        "label": "run_ini_serial",
        "type": "shell",
        "command": "cd test_serial && ./inigrid.x && ./inirand.x && ./iniflow.x && ./iniscal.x && mv flow.ics.1 flow.0.1 && mv flow.ics.2 flow.0.2 && mv flow.ics.3 flow.0.3 && mv scal.ics.1 scal.0.1"
      }, 
      //-----------------------------------------------------------------------------------------------------------------//
      {
        "label":"prep_test_parallel",
        "dependsOn":[
          "clear_test_parallel",
          "create_links_parallel",
          "run_ini_parallel"
        ],
        "dependsOrder": "sequence",
      },
      {
        "label": "clear_test_parallel",
        "type": "shell",
        "command": "cd test_parallel && rm -rf * "//find . ! -name dns.ini -delete"    
      },
      {
        "label": "create_links_parallel",
        "type": "shell",
        "command": "cd test_parallel && ln -s ../test_files/dns.ini && ln -s ../build_PARALLEL/inigrid.x && ln -s ../build_PARALLEL/inirand.x && ln -s ../build_PARALLEL/iniscal.x && ln -s ../build_PARALLEL/iniflow.x && ln -s ../build_PARALLEL/dns.x"
      },
      {
        "label": "run_ini_parallel",
        "type": "shell",
        "command": "cd test_parallel && ./inigrid.x && mpirun -np 4 ./inirand.x && mpirun -np 4 ./iniflow.x && mpirun -np 4 ./iniscal.x && mv flow.ics.1 flow.0.1 && mv flow.ics.2 flow.0.2 && mv flow.ics.3 flow.0.3 && mv scal.ics.1 scal.0.1"
      },
      //-----------------------------------------------------------------------------------------------------------------//
    ]
}